--Tablak letrehozasa
select * from Alkalmazottak;
select * from Osztalyok;
select * from AlkalmazottakFeladatai;
select * from Feladatok;
select * from Ugyfelek;
select * from Rendelesek;
select * from Autok;
select * from Alkatreszek;
select * from Beszallitok;
select * from Auto_Tipus;
select * from Tartalom_Autok;
select * from Tartalom_Alkatreszek;

--Alkalmazottak tabla
create table Alkalmazottak (alkalmazott_id number generated by default as identity (start with 100) primary key,
                            alkalmazot_vezeteknev varchar2(50),
                            alkalmazott_keresztnev varchar2(50),
                            alkalmazott_fizetes number(5),
                            alkalmazott_telefonszam varchar2(10),
                            osztaly_id number(5), 
                            FOREIGN KEY (osztaly_id) REFERENCES Osztalyok(osztaly_id));
                            
drop table Alkalmazottak;
delete from Alkalmazottak where alkalmazott_id = 109;

select * from Alkalmazottak;


insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Bressel', 'Robert', 1500, '0746589325', 10);
                          

insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Penzes', 'Miklos', 1100, '0749846375', 10);
                          

insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Kohan', 'Roland', 1600, '0748232647', 14);

                          
insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Filer', 'Ivan', 1400, '0746578124', 14);
                          

insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Darnics', 'Norbert', 1700, '0747763298', 12);
                          

insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Hochdorfer', 'Arnold', 1200, '0747854565', 12);
                          

insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Tivadar', 'Nandor', 1500, '0743265745', 12);
                          

insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Szabo', 'Istvan', 1800, '0747845123', 14);
                          

insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Oros', 'Sorin', 1400, '0746523164', 18);
                          

insert into Alkalmazottak(alkalmazot_vezeteknev,
                          alkalmazott_keresztnev, 
                          alkalmazott_fizetes,
                          alkalmazott_telefonszam,
                          osztaly_id)
values('Marton', 'Aron', 2700, '0749856743', 11);

--Osztalyok tabla

create table Osztalyok (osztaly_id number generated by default as identity (start with 10) primary key,
                        osztaly_nev varchar2(50),
                        osztaly_rovidites varchar2(3),
                        osztaly_email varchar2(100));
                            
drop table Osztalyok;
delete from Osztalyok where osztaly_id = 16;
select * from Osztalyok;

insert into Osztalyok ( osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Logisztika', 'LOG', 'logisztika_mail@fordwest.ro');

                      
insert into Osztalyok (osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Konyveloseg', 'KVL', 'konyveloseg_mail@fordwest.ro');
                       

insert into Osztalyok ( osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Auto eladas', 'AUE', 'autoelad_mail@fordwest.ro');

                      
insert into Osztalyok ( osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Alkatresz eladas', 'ALE', 'alkatreszelad_mail@fordwest.ro');

                      
insert into Osztalyok (osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Szerviz', 'SER', 'szerviz_mail@fordwest.ro');
                       

insert into Osztalyok ( osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Badogos', 'BDG', 'badogos_mail@fordwest.ro');

                      
insert into Osztalyok (osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Mosoda', 'MSD', 'mosoda_mail@fordwest.ro');
                       

insert into Osztalyok ( osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Marketing', 'MKT', 'marketing_mail@fordwest.ro');

                      
insert into Osztalyok ( osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Auto muszaki', 'AUM', 'muszaki_mail@fordwest.ro');

                      
insert into Osztalyok (osztaly_nev,
                       osztaly_rovidites,
                       osztaly_email)
values('Biztosito', 'BZT', 'biztosito_mail@fordwest.ro');
                       
--Autok tabla

create table Autok (auto_id number generated by default as identity (start with 1) primary key,
                    auto_ev number(4),
                    auto_ar number(7),
                    auto_teljesitmeny number(4),
                    auto_uzemanyag varchar2(20),
                    beszallito_id number(5),
                    auto_tipus_id number(5),
                    foreign key (beszallito_id) references Beszallitok(beszallito_id),
                    foreign key (auto_tipus_id) references Auto_tipus(auto_tipus_id));
                            
drop table Autok;
delete from Autok where auto_id = 10;
select * from Autok;

insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2023', 23800, 120, 'Hybrid',1,1);
                   

insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2022', 24900, 140, 'Benzin',2,2);
                  

insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2023', 31100, 160, 'Benzin',3,3);
                   

insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2023', 53500, 260, 'Electric',4,4);
                   

insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2021', 51587, 150, 'Diesel',5,5);
                   

insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2023', 79400, 200, 'Electric',6,6);

                  
insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2022', 52500, 300, 'Benzin',7,7);
                   

insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2023', 27100, 180, 'Diesel',8,8);
                   

insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2022', 34800, 130, 'Benzin',9,9);
                   

insert into Autok (
                   auto_ev,
                   auto_ar,
                   auto_teljesitmeny,
                   auto_uzemanyag,
                   beszallito_id,
                   auto_tipus_id)
values('2023', 29685, 160, 'Diesel',10,10);
                   
create table Auto_Tipus( auto_tipus_id number generated by default as identity (start with 1) primary key,
                        auto_tius_nev varchar2(50),
                        auto_tipus varchar2(50),
                        auto_tipus_ev number(5));
                        
select * from Auto_Tipus;

insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Puma', 2020);

insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Focus', 2002);
                        
insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Kuga', 2015);

insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Mustang Mach-e', 2020);

insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Tourneo', 2018);

insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Bronco', 2017);

insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Mustang', 1987);

insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Focus Active', 2005);

insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Puma ST', 2021);

insert into Auto_Tipus(auto_tius_nev,
                        auto_tipus,
                        auto_tipus_ev)
values('Ford', 'Tourneo Connect', 2022);

--Ugyfelek tabla
create table Ugyfelek (ugyfel_id number generated by default as identity (start with 1) primary key,
                       ugyfel_vezeteknev varchar2(50),
                       ugyfel_keresztnev varchar2(50),
                       ugyfel_telefonszam varchar2(10),
                       ugyfel_email varchar2(100),
                       ugyfel_orszag varchar2(50),
                       ugyfel_telepules varchar2(50),
                       ugyfel_lakcim varchar2(50));
                            
drop table Ugyfelek;
delete from Ugyfelek where ugyfel_id = 9;

select * from Ugyfelek;

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Bressel', 'Mark', '0741321246', 'markbressel@gmail.com','Romania', 'Szatmarnemeti', 'Ana Ipatescu Nr. 2');

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Totos', 'Armand', '0749865723', 'armandtotos@gmail.com','Romania', 'Zilah', 'Avram Iancu Nr. 56');

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Ricciardo', 'Matteo', '3987564128', 'matteor@gmail.com','Olaszorszag', 'Roma', 'Piazza di S. Marco Nr. 123');

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Petho', 'Emilia', '0748745326', 'emiliapetho@gmail.com','Romania', 'Kovaszna', 'Toth utca Nr. 16');

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Freund', 'Fritz', '4987563256', 'ffritz@gmail.com','Nemetorszag', 'Munchen', 'Rheinstrasse Nr. 45');

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Kovacs', 'Istvan', '3687456387', 'kovacsistvan@yahoo.com','Magyarorszag', 'Kecskemet', 'Csiksomlyoi ut Nr. 98');

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Isac', 'Marcela', '0749856327', 'marcelaisac@yahoo.com','Romania', 'Szatmarnemeti', 'Corneliu Coposu Nr. 5');

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Maier', 'Mariana', '0743376456', 'maiermaria@gmail.com','Romania', 'Szatmarnemeti', 'Bulevardul Lucian Blaga Nr. 86');

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Codrianu', 'Petru', '0748743657', 'petru.codrianu@gmail.com','Romania', 'Szatmarnemeti', 'Str. Nicolae Iorga Nr. 9');

insert into Ugyfelek(ugyfel_vezeteknev,
                     ugyfel_keresztnev, 
                     ugyfel_telefonszam,
                     ugyfel_email,
                     ugyfel_orszag,
                     ugyfel_telepules,
                     ugyfel_lakcim)
values('Muresan', 'Alin', '0743364181', 'alin.muresan@yahoo.com','Romania', 'Szatmarnemeti', 'Str. Odoreului Nr. 12');

--Rendelesek tabla
create table Rendelesek (rendeles_id number generated by default as identity (start with 1) primary key,
                         rendeles_nev varchar2(50),
                         rendeles_darab number(5),
                         rendeles_ar number(8),
                         rendeles_datum date,
                         alkalmazott_id number(5),
                         ugyfel_id number(5),
                         FOREIGN KEY (alkalmazott_id) REFERENCES Alkalmazottak(alkalmazott_id),
                         FOREIGN KEY (ugyfel_id) REFERENCES Ugyfelek(ugyfel_id));
                            
drop table Rendelesek;
delete from Rendelesek where rendeles_id = 21;

select * from Rendelesek;

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('Autonet Import SRL', 50, 25000, to_date('August 1, 2023', 'Month fmdd, yyyy'), 100, 1);

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('Pilkington', 3, 12500, to_date('January 3, 2024', 'Month fmdd, yyyy'), 100, 2);

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('UNIX Auto SRL', 75, 86980, to_date('December 18, 2023', 'Month fmdd, yyyy'), 101, 3);

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('Ausburg Auto', 5, 5600, to_date('September 28, 2023', 'Month fmdd, yyyy'), 101, 4);

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('Autototal', 83, 125200, to_date('April 25, 2023', 'Month fmdd, yyyy'), 104, 5);

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('Bardi Auto SRL', 65, 85000, to_date('October 18, 2023', 'Month fmdd, yyyy'),105, 6);

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('Inter Cars Romania', 23, 7460, to_date('May 9, 2023', 'Month fmdd, yyyy'),100, 7);

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('Marsorom', 78, 56800, to_date('December 1, 2023', 'Month fmdd, yyyy'),105, 8);

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('Castrol', 2500, 50000, to_date('November 23, 2023', 'Month fmdd, yyyy'),101, 9);

insert into Rendelesek(rendeles_nev,
                       rendeles_darab,
                       rendeles_ar,
                       rendeles_datum,
                       alkalmazott_id,
                       ugyfel_id)
values('Elgeka', 3000, 65000, to_date('November 24, 2023', 'Month fmdd, yyyy'), 104, 10);

--Alkatreszek tabla
create table Alkatreszek (alkatresz_id number generated by default as identity (start with 1) primary key,
                          alkatresz_nev varchar2(50),
                          alaktresz_tipus varchar2(50),
                          alkatresz_marka varchar2(50),
                          alkatresz_ar number(5),
                          alkatresz_keszites varchar2(50),
                          beszallito_id number(5),
                          foreign key (beszallito_id) references Beszallitok(beszallito_id));
                          
drop table Alkatreszek;
delete from Alkatreszek where alkatresz_id = 1;

select * from Alkatreszek;

insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Olajszuro', 'Kopo alkatresz', 'Mann-Filter', 6, 'Nemetorszag',1);
                          
insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Uzemanyagszuro', 'Kopo alkatresz', 'Mahle', 43, 'Nemetorszag',1);

insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Fektarcsa', 'Kopo alkatresz', 'Brembo', 580, 'Olaszorszag', 3);

insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Fekbetet', 'Kopo alkatresz', 'TRW', 360, 'Amerikai Egyesult Allamok', 4);

insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Elso lampa', 'Karosszeria', 'Valeo', 1360, 'Franciaorszag', 5);

insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Szelvedo', 'Karosszeria', 'Saint Gobain', 2600, 'Franciaorszag',6);

insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Rugo', 'Felfuggesztes', 'Delphi', 200, 'Amerikai Egyesult Allamok',7);

insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Lengokar', 'Felfuggesztes', 'TRW', 266, 'Amerikai Egyesult Allamok',9);

insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Motorolaj', 'Folyadek', 'Castrol', 20, 'Egyesult Kiralysag', 7);

insert into Alkatreszek(alkatresz_nev,
                        alaktresz_tipus,
                        alkatresz_marka,
                        alkatresz_ar,
                        alkatresz_keszites,
                        beszallito_id)
values('Fagyallo', 'Folyadek', 'Valvoline', 8, 'Amerikai Egyesult Allamok', 10);


--Beszallitok tabla
create table Beszallitok (beszallito_id number generated by default as identity (start with 1) primary key,
                          beszallito_nev varchar2(50),
                          beszallito_telefonszam varchar2(10),
                          beszallito_email varchar2(50));
                            
drop table Beszallitok;
delete from Beszallitok where beszallito_id = 1;

select * from Beszallitok;

insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('Autonet Import SRL', '0756984123', 'autonetsrl@gmail.com');

insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('Pilkington', '0774563256', 'pilkington@yahoo.com');
                     
insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('UNIX Auto SRL', '0741321246', 'unixauto@gmail.com');

insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('Ausburg Auto', '0778548963', 'ausburgauto@gmail.com');

insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('Autototal', '0742659874', 'autototal@yahoo.com');

insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('Bardi Auto SRL', '0765324579', 'bardiauto@gmail.com');

insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('Inter Cars Romania', '0742136591', 'intercars@gmail.com');

insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('Marsorom', '0774365214', 'marsoromauto@yahoo.com');

insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('Castrol', '0749875632', 'castroloil@gmail.com');

insert into Beszallitok (beszallito_nev,
                         beszallito_telefonszam,
                         beszallito_email)
values('Elgeka', '0787965433', 'elgekaoil@yahoo.com');

--Feladatok tabla
create table Feladatok (feladat_id number generated by default as identity (start with 1) primary key,
                        feladat_nev varchar2(50),
                        feladat_munkaido number(2),
                        feladat_helyszin varchar2(50));
                        
drop table Feladatok;
delete from Feladatok where feladat_id = 1;

select * from Feladatok;

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Logisztika', 8, 'Autoszalon');

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Konyveles', 6, 'Iroda');

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Auto eladas', 8, 'Autoszalon');

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Alkatresz eladas', 8, 'Raktar');

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Auto szereles', 10, 'Szerviz');

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Auto karosszeria javitas', 8, 'Badogos szerviz');

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Auto mosas', 5, 'Mosoda');

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Marketing', 8, 'Autoszalon');

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Auto muszaki diagnoztizalas', 8, 'Muszaki allomas');

insert into Feladatok (feladat_nev,
                       feladat_munkaido,
                       feladat_helyszin)
values('Auto biztositas eloallitas', 7, 'Biztositasi iroda');

--AlkalmazottakFeladatai
create table AlkalmazottakFeladatai (alkalmazott_id number(5),
                                     feladat_id number(5),
                                     primary key (alkalmazott_id, feladat_id),
                                     foreign key (alkalmazott_id) references Alkalmazottak(alkalmazott_id),
                                     foreign key (feladat_id) references Feladatok(feladat_id));

select * from alkalmazottakFeladatai;

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(100, 1);

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(100, 4);

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(101, 1);

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(101, 4);

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(102, 5);

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(103, 5);

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(104, 8);

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(105, 8);

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(106, 8);

insert into AlkalmazottakFeladatai (alkalmazott_id,
                                     feladat_id)
values(106, 3);

--Tartalom_Autok tabla
create table Tartalom_Autok (rendeles_id number(5),
                             auto_id number(5),
                             darab number(5),
                             ar number(8),
                             primary key (rendeles_id, auto_id),
                             foreign key (rendeles_id) references Rendelesek(rendeles_id),
                             foreign key (auto_id) references Autok(auto_id));
                            
drop table Tartalom_Autok;
select * from Tartalom_Autok;

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(1, 1, 2, 47600);

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(2, 2, 1, 24900);

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(3, 3, 1, 31100);

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(4, 4, 2, 107000);

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(5, 5, 1, 51587);

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(6, 6, 3, 238200);

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(7, 7, 2, 105000);

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(8, 8, 1, 27100);

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(9, 9, 1, 34800);

insert into Tartalom_Autok( rendeles_id,
                            auto_id,
                            darab,
                            ar)
values(10, 10, 2, 59370);

--Tartalom_Alkatreszek tabla

create table Tartalom_Alkatreszek (rendeles_id number(5),
                             alkatresz_id number(5),
                             darab number(5),
                             ar number(8),
                             primary key (rendeles_id, alkatresz_id),
                             foreign key (rendeles_id) references Rendelesek(rendeles_id),
                             foreign key (alkatresz_id) references Alkatreszek(alkatresz_id));
                            
drop table Tartalom_Alkatreszek;
select * from Tartalom_Alkatreszek;


insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(1, 1, 3, 18);

insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(2, 2, 5, 215);

insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(3, 3, 6, 3480);

insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(4, 4, 2, 720);

insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(5, 5, 15, 20400);

insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(6, 6, 2, 5200);

insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(7, 9, 2, 400);

insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(8, 1, 6, 1596);

insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(9, 3, 5, 100);

insert into Tartalom_Alkatreszek( rendeles_id,
                                  alkatresz_id,
                                  darab,
                                  ar)
values(10, 4, 5, 40);

--Lekerdezesek 
select * from Alkalmazottak;
select * from Osztalyok;
select * from AlkalmazottakFeladatai;
select * from Feladatok;
select * from Ugyfelek;
select * from Rendelesek;
select * from Autok;
select * from Alkatreszek;
select * from Beszallitok;
select * from Auto_Tipus;
select * from Tartalom_Autok;
select * from Tartalom_Alkatreszek;

--1. Az alkalmazottak havonta ennyi penzt keresnek
select alkalmazot_vezeteknev || ' ' || alkalmazott_keresztnev || ' havi keresete ' || alkalmazott_fizetes || ' euro ' 
as "Havi fizetes"
from alkalmazottak;

--2. Azon autokat, melyeknek a teljesitmenye 100 es 150 loero kozott van
select auto_tius_nev, auto_tipus, auto_teljesitmeny
from auto_tipus
join Autok On Auto_tipus.auto_tipus_id = Autok.auto_tipus_id
where auto_teljesitmeny between 100 and 150;

--3. Azok az alkalmazottak, akik a logisztika osztalyon dolgoznak
select alkalmazott_id,alkalmazot_vezeteknev, alkalmazott_keresztnev
from Alkalmazottak
join Osztalyok on Alkalmazottak.osztaly_id = Osztalyok.osztaly_id
where osztaly_nev = 'Logisztika';

--4. A nemetorszagban gyartott kopo alkatreszek, ar szerint csokkeno sorrendben
select alkatresz_nev, alkatresz_marka, alkatresz_ar
from alkatreszek
where alaktresz_tipus = 'Kopo alkatresz'
and alkatresz_keszites = 'Nemetorszag'
order by alkatresz_ar desc, alkatresz_nev, alkatresz_marka;

--5. Az alkalmazottak milyen osztlayon dolgoznak?
select alkalmazot_vezeteknev, alkalmazott_keresztnev,
case osztaly_id
    when 10 then 'Logisztika'
    when 11 then 'Konyveloseg'
    when 12 then 'Auto eladas'
    when 13 then 'Alkatresz eladas'
    when 14 then 'Szerviz'
    when 15 then 'Badogos'
    when 16 then 'Mosoda'
    when 17 then 'Marketing'
    when 18 then 'Auto muszaki'
    when 19 then 'Biztosito'
end as "Osztalyok"
from Alkalmazottak;
    
--6. Milyen alkatresz milyen beszallitotol erkezik
select a.alkatresz_nev, b.beszallito_nev
from alkatreszek a, beszallitok b
where a.alkatresz_id = b.beszallito_id;

--7. Ahol tobb mint egy alkalmazott dolgozik
select a.osztaly_id, max(a.alkalmazott_fizetes)
from alkalmazottak a
join osztalyok o on a.osztaly_id = o.osztaly_id
group by a.osztaly_id
having count(*) > 1
order by a.osztaly_id;

--8. Alkalmazott neve es feladata with - el
with Alkalmazott_Feladatok as (
    select af.alkalmazott_id, af.feladat_id, a.alkalmazot_vezeteknev, a.alkalmazott_keresztnev, f.feladat_nev
    from AlkalmazottakFeladatai af
    join Alkalmazottak a on af.alkalmazott_id = a.alkalmazott_id
    join Feladatok f on af.feladat_id = f.feladat_id
)
select af.alkalmazot_vezeteknev, af.alkalmazott_keresztnev, af.feladat_nev
from Alkalmazott_Feladatok af;

--9. Azoknak a fizetese, akinek nagyobb az atlagnal (allekerdezes)
select alkalmazot_vezeteknev, alkalmazott_keresztnev, alkalmazott_fizetes
from Alkalmazottak
where alkalmazott_fizetes > (
    select avg(alkalmazott_fizetes)
    from Alkalmazottak
);

--10. A rendeles darabszama legalabb 2 darab (allekerdezes)
select rendeles_nev, rendeles_darab, rendeles_ar
from Rendelesek
where rendeles_id in (
    select rendeles_id
    from Tartalom_Autok
    where darab >= 2
);

--11. Azokat az autokat, amelyeknek az evjarata kisebb, mint az atlag evjarat (korrelalt allekerdezes)
select at.auto_tius_nev, at.auto_tipus_ev
from Auto_Tipus at
where at.auto_tipus_ev < (
    select avg(at_inner.auto_tipus_ev)
    from Auto_Tipus at_inner
    where at_inner.auto_tius_nev = at.auto_tius_nev
);

--12. Sajat osztalyon belul magasabb fizetest az atlagnal, ugy hogy az osztalyon ketto vagy tobb alkalmazott van
select alkalmazot_vezeteknev, alkalmazott_keresztnev, alkalmazott_fizetes
from Alkalmazottak alk
where alk.alkalmazott_fizetes > (
    select avg(alk_inner.alkalmazott_fizetes)
    from Alkalmazottak alk_inner
    where alk_inner.osztaly_id = alk.osztaly_id
)
and alk.osztaly_id in (
    select osztaly_id
    from Alkalmazottak
    group by osztaly_id
    having count(*) >= 2
);

--13. Az ugyfelek es alkalmazottak kiirasa uniont felhasznalva
select alkalmazot_vezeteknev as nev_vezeteknev, alkalmazott_keresztnev as nev_keresztnev, 'Alkalmazott' as tipus
from Alkalmazottak
union
select ugyfel_vezeteknev as nev_vezeteknev, ugyfel_keresztnev as nev_keresztnev, 'Ugyfel' as tipus
from Ugyfelek
order by tipus desc;

--14. Azokat az autokat es az uzemanyag tipusat, amelyek meghaladjak az atlag arat
select auto_uzemanyag, avg(auto_ar) as atlag_ar
from Autok
group by auto_uzemanyag
having avg(auto_ar) > (
    select avg(auto_ar)
    from Autok
);

--15. Random kiir egy alkalmazottat, es az osszes adatait (modern sql)
select alkalmazot_vezeteknev, alkalmazott_keresztnev, alkalmazott_fizetes
from Alkalmazottak
order by DBMS_RANDOM.value
fetch first 1 row only;

--16. A fizetesek alapjan rakja sorrendbe az alkalmazottakat (modern sql rank())
select alkalmazot_vezeteknev, alkalmazott_keresztnev, alkalmazott_fizetes,
rank() over(order by alkalmazott_fizetes desc) as fizetes_rangsor
from Alkalmazottak;

--17. Listazza az utolso rendelest, aszerint hogy ki adta le a rendelest
with AlkalmazottakRendelesek as (
select a.alkalmazot_vezeteknev, a.alkalmazott_keresztnev, o.osztaly_nev, r.rendeles_nev,
row_number() over (partition by a.alkalmazott_id order by r.rendeles_datum desc) as row_num
    from Alkalmazottak a
    join Rendelesek r on a.alkalmazott_id = r.alkalmazott_id
    join Osztalyok o on a.osztaly_id = o.osztaly_id)
select alkalmazot_vezeteknev, alkalmazott_keresztnev, osztaly_nev, rendeles_nev
from AlkalmazottakRendelesek
where row_num = 1;

--18. Azokat az alkatreszeket, amelyek 'o' betuvel vegzodnek
select alkatresz_nev
from Alkatreszek
where regexp_like(alkatresz_nev, 'o$');

--19. Hany 'e' betu van az alkatresz keszites tablak soraiban?
select alkatresz_keszites, regexp_count(alkatresz_keszites, 'e', 1, 'i') as "'e' betu a keszitesek neveben" 
from Alkatreszek;

--20. Azok az alkalmazottak akiknek a masodik betu a neveben maganhangzo
select *
from Alkalmazottak
where regexp_like(alkalmazot_vezeteknev, '^[^aeiouAEIOU][aeiouAEIOU]');


--Explain plan
--1. 2.feladat
explain plan for
select auto_tius_nev, auto_tipus, auto_teljesitmeny
from auto_tipus
join Autok On Auto_tipus.auto_tipus_id = Autok.auto_tipus_id
where auto_teljesitmeny between 100 and 150;
select * from table(dbms_xplan.display);

--2. 15.feladat
explain plan for
select alkalmazot_vezeteknev, alkalmazott_keresztnev, alkalmazott_fizetes
from Alkalmazottak
order by DBMS_RANDOM.value
fetch first 1 row only;
select * from table(dbms_xplan.display);

--3. 9.feladat
explain plan for
select alkalmazot_vezeteknev, alkalmazott_keresztnev, alkalmazott_fizetes
from Alkalmazottak
where alkalmazott_fizetes > (
    select avg(alkalmazott_fizetes)
    from Alkalmazottak);
select * from table(dbms_xplan.display);

--4. 7.feladat
explain plan for
select a.osztaly_id, max(a.alkalmazott_fizetes)
from alkalmazottak a
join osztalyok o on a.osztaly_id = o.osztaly_id
group by a.osztaly_id
having count(*) > 1
order by a.osztaly_id;
select * from table(dbms_xplan.display);

--5. 6.feladat
explain plan for
select a.alkatresz_nev, b.beszallito_nev
from alkatreszek a, beszallitok b
where a.alkatresz_id = b.beszallito_id;
select * from table(dbms_xplan.display);

--Json fajlok letrehozasa
select * from Alkalmazottak;
select * from Osztalyok;

DECLARE
    alkalmazottak_json CLOB;
    osztalyok_json CLOB;
BEGIN
    alkalmazottak_json := '{"alkalmazott_id": 110, "alkalmazot_vezeteknev": "Szallasy", "alkalmazott_keresztnev": "Tamas", "alkalmazott_fizetes": 2000, "alkalmazott_telefonszam": "0765321698", "osztaly_id": 18}';
    osztalyok_json := '{"osztaly_id": 20, "osztaly_nev": "Karbantarto", "osztaly_rovidites": "KBT", osztaly_email: "karbantarto_mail@fordwest.ro"}';

    INSERT INTO Alkalmazottak (
        alkalmazott_id,
        alkalmazot_vezeteknev,
        alkalmazott_keresztnev,
        alkalmazott_fizetes,
        alkalmazott_telefonszam,
        osztaly_id
    ) VALUES (
        JSON_VALUE(alkalmazottak_json, '$.alkalmazott_id'),
        JSON_VALUE(alkalmazottak_json, '$.alkalmazot_vezeteknev'),
        JSON_VALUE(alkalmazottak_json, '$.alkalmazott_keresztnev'),
        JSON_VALUE(alkalmazottak_json, '$.alkalmazott_fizetes'),
        JSON_VALUE(alkalmazottak_json, '$.alkalmazott_telefonszam'),
        JSON_VALUE(alkalmazottak_json, '$.osztaly_id')
    );

    INSERT INTO Osztalyok (
        osztaly_id,
        osztaly_nev,
        osztaly_rovidites,
        osztaly_email
    ) VALUES (
        JSON_VALUE(osztalyok_json, '$.osztaly_id'),
        JSON_VALUE(osztalyok_json, '$.osztaly_nev'),
        JSON_VALUE(osztalyok_json, '$.osztaly_rovidites'),
        JSON_VALUE(osztalyok_json, '$.osztaly_email')
    );
    
    COMMIT; 
END;
/